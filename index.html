<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–µ—ñ–Ω—Ç –û–Ω–ª–∞–π–Ω</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 15px;
            /* –¶–µ–Ω—Ç—Ä—É—î–º–æ –≤–µ—Å—å –≤–º—ñ—Å—Ç */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            gap: 15px;
        }

        h1 {
            color: #0366d6;
            margin: 0;
        }

        .controls {
            display: flex;
            flex-wrap: wrap; /* –î–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ –Ω–∞ –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫ –Ω–∞ –º–∞–ª–∏—Ö –µ–∫—Ä–∞–Ω–∞—Ö */
            justify-content: center;
            align-items: center;
            gap: 10px 15px;
            background-color: #fff;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 900px;
            box-sizing: border-box; /* –í—Ä–∞—Ö–æ–≤—É—î padding —É —à–∏—Ä–∏–Ω—É */
        }
        
        .controls label {
            font-weight: bold;
        }

        .controls input[type="color"] {
            width: 40px;
            height: 40px;
            border: none;
            cursor: pointer;
            background: none;
            padding: 0;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
        .controls button {
            padding: 10px 15px;
            border: none;
            color: white;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .clear-button {
            background-color: #ff4757;
        }
        
        .save-button {
            background-color: #28a745;
        }
        
        .clear-button:hover {
            background-color: #e04050;
        }

        .save-button:hover {
            background-color: #218838;
        }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –ø–æ–ª–æ—Ç–Ω–∞ */
        #paintCanvas {
            border: 2px solid #ccc;
            background-color: #fff; /* –ë—ñ–ª–∏–π —Ñ–æ–Ω –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É PNG */
            cursor: crosshair;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            touch-action: none; /* –í–∞–∂–ª–∏–≤–æ –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö, —â–æ–± –Ω–µ —Å–∫—Ä–æ–ª–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É */
            max-width: 100%; /* –ü–æ–ª–æ—Ç–Ω–æ –Ω–µ –±—É–¥–µ –≤–∏—Ö–æ–¥–∏—Ç–∏ –∑–∞ –º–µ–∂—ñ –µ–∫—Ä–∞–Ω—É */
        }
    </style>
</head>
<body>

    <h1>üé® –ü–µ—ñ–Ω—Ç –û–Ω–ª–∞–π–Ω</h1>

    <div class="controls">
        <label for="colorPicker">–ö–æ–ª—ñ—Ä:</label>
        <input type="color" id="colorPicker" value="#000000">
        
        <label for="brushSize">–†–æ–∑–º—ñ—Ä:</label>
        <input type="range" id="brushSize" min="1" max="50" value="5">
        <span id="brushSizeValue">5</span>
        
        <button id="clearButton" class="clear-button">–û—á–∏—Å—Ç–∏—Ç–∏</button>
        <button id="saveButton" class="save-button">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
    </div>

    <canvas id="paintCanvas"></canvas>

    <script>
        const canvas = document.getElementById('paintCanvas');
        const ctx = canvas.getContext('2d');

        const colorPicker = document.getElementById('colorPicker');
        const brushSizeInput = document.getElementById('brushSize');
        const brushSizeValue = document.getElementById('brushSizeValue');
        const clearButton = document.getElementById('clearButton');
        const saveButton = document.getElementById('saveButton');

        let painting = false;
        let brushColor = '#000000';
        let brushWidth = 5;

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–ª–∏–≤–∫–∏ –ø–æ–ª–æ—Ç–Ω–∞ –±—ñ–ª–∏–º —Ñ–æ–Ω–æ–º
        function fillCanvasBackground() {
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –ø–æ–ª–æ—Ç–Ω–∞
        function resizeCanvas() {
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π –º–∞–ª—é–Ω–æ–∫
            const currentDrawing = canvas.toDataURL();

            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ä–æ–∑–º—ñ—Ä –ø–æ–ª–æ—Ç–Ω–∞, –≤—Ä–∞—Ö–æ–≤—É—é—á–∏ —Ä–æ–∑–º—ñ—Ä –ø–∞–Ω–µ–ª—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤
            const controlsHeight = document.querySelector('.controls').offsetHeight;
            const availableHeight = window.innerHeight - controlsHeight - 80; // 80px - –≤—ñ–¥—Å—Ç—É–ø–∏ —Ç–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫

            canvas.width = document.body.clientWidth * 0.95;
            canvas.height = availableHeight;
            
            // –ó–∞–ª–∏–≤–∞—î–º–æ –Ω–æ–≤–µ –ø–æ–ª–æ—Ç–Ω–æ –±—ñ–ª–∏–º –∫–æ–ª—å–æ—Ä–æ–º
            fillCanvasBackground();

            // –í—ñ–¥–Ω–æ–≤–ª—é—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –º–∞–ª—é–Ω–æ–∫
            const img = new Image();
            img.src = currentDrawing;
            img.onload = () => {
                ctx.drawImage(img, 0, 0);
            };
        }

        function getEventCoordinates(event) {
            const rect = canvas.getBoundingClientRect();
            if (event.touches) {
                return { x: event.touches[0].clientX - rect.left, y: event.touches[0].clientY - rect.top };
            }
            return { x: event.clientX - rect.left, y: event.clientY - rect.top };
        }

        function startPosition(e) {
            e.preventDefault();
            painting = true;
            draw(e);
        }

        function endPosition() {
            painting = false;
            ctx.beginPath();
        }

        function draw(e) {
            if (!painting) return;
            e.preventDefault();
            
            const { x, y } = getEventCoordinates(e);

            ctx.lineWidth = brushWidth;
            ctx.lineCap = 'round';
            ctx.strokeStyle = brushColor;
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }
        
        // --- –°–ª—É—Ö–∞—á—ñ –ø–æ–¥—ñ–π –¥–ª—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ ---
        colorPicker.addEventListener('input', (e) => { brushColor = e.target.value; });
        brushSizeInput.addEventListener('input', (e) => {
            brushWidth = e.target.value;
            brushSizeValue.textContent = brushWidth;
        });
        clearButton.addEventListener('click', fillCanvasBackground);
        
        saveButton.addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = `–º–∞–ª—é–Ω–æ–∫_${Date.now()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
        });

        // --- –°–ª—É—Ö–∞—á—ñ –ø–æ–¥—ñ–π –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è ---
        canvas.addEventListener('mousedown', startPosition);
        canvas.addEventListener('mouseup', endPosition);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseout', endPosition);
        
        canvas.addEventListener('touchstart', startPosition);
        canvas.addEventListener('touchend', endPosition);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchcancel', endPosition);
        
        // --- –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å ---
        window.addEventListener('resize', resizeCanvas);
        // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä –ø–æ–ª–æ—Ç–Ω–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        resizeCanvas();
    </script>
</body>
</html>